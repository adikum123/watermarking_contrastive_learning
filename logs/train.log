Loading precomputed ljspeech datasets
2025-09-22 09:46:59,927 [INFO] :package: train loader ready → samples=12000, batch_size=2, total_workers=0, worker2025-09-22 09:46:59,928 [INFO] :packag2025-09-22 09:46:59,928 [INFO] :package: train loader ready → samples=500, batch_size=2, total_workers=0, workers2025-09-22 09:46:59,928 [INFO] Device:2025-02025-09-22 09:47:15,219 [INFO] Trainin2025-09-22 09:47:15,219 [INFO] Training with params:
{
    "adv": false,
    "watermark": {
        "length": 15
    },
    "optimize": {
        "gradient_scaling": true,
        "lr": 0.001,
        "lambda_e": 1.0,
        "lambda_m": 0.05,
        "lambda_a": 0.01,
        "lambda_cl": 0.1,
        "batch_size": 2,
        "step_size": 5,
        "gamma": 0.9,
        "betas": [
            0.9,
            0.98
        ],
        "eps": 1e-09,
        "weight_decay": 0.0,
        "grad_clip_thresh": 1.0,
        "grad_acc_step": 16,
        "up_step": 4000,
        "anneal_steps": [
            300000,
            400000,
            500000
        ],
        "anneal_rate": 0.3,
        "lr_disc": 2e-05,
        "alpha": 10
    },
    "contrastive": {
        "loss_type": "info_nce"
    },
    "iter": {
        "epoch": 20,
        "save_circle": 5,
        "show_circle": 100,
        "val_circle": 100
 2025-09-22 09:47:15,219 [INFO] Epoch: 202025-09-22 09:47:16,995 [INFO] {
    "2025-09-22 09:47:16,995 [INFO] {
    "loss": 2.7374727,
    "pesq": 1.11776,
    "avg_acc_identity": 0.432025-09-22 09:49:02,926 [INFO] {
    "2025-09-22 09:49:02,926 [INFO] {
    "loss": 2.1953268,
    "pesq": 1.57694,
    "avg_acc_identity": 0.52025-09-22 09:50:46,814 [INFO] {
    "2025-09-22 09:50:46,814 [INFO] {
    "loss": 2.1756865,
    "pesq": 1.86836,
    "avg_acc_identity": 0.502025-09-22 09:52:31,521 [INFO] {
    "2025-09-22 09:52:31,521 [INFO] {
    "loss": 2.1626036,
    "pesq": 2.09265,
    "avg_acc_identity": 0.42025-09-22 09:54:15,061 [INFO] {
    "2025-09-22 09:54:15,061 [INFO] {
    "loss": 2.1491653,
    "pesq": 2.20626,
    "avg_acc_identity": 0.492025-09-22 09:55:58,618 [INFO] {
    "2025-09-22 09:55:58,618 [INFO] {
    "loss": 2.13961,
    "pesq": 2.33313,
    "avg_acc_identity": 0.492025-09-22 09:57:42,374 [INFO] {
    "2025-09-22 09:57:42,374 [INFO] {
    "loss": 2.1241376,
    "pesq": 2.43615,
    "avg_acc_identity": 0.492025-09-22 09:59:25,489 [INFO] {
    "2025-09-22 09:59:25,489 [INFO] {
    "loss": 2.1193368,
    "pesq": 2.50319,
    "avg_acc_identity": 0.492025-09-22 10:01:08,556 [INFO] {
    "2025-09-22 10:01:08,556 [INFO] {
    "loss": 2.113529,
    "pesq": 2.54277,
    "avg_acc_identity": 0.42025-09-22 10:02:53,375 [INFO] {
    "2025-09-22 10:02:53,375 [INFO] {
    "loss": 2.10591,
    "pesq": 2.58177,
    "avg_acc_identity": 0.502025-09-22 10:04:39,021 [INFO] {
    "2025-09-22 10:04:39,021 [INFO] {
    "loss": 2.1014299,
    "pesq": 2.62158,
    "avg_acc_identity": 0.502025-09-22 10:06:23,930 [INFO] {
    "2025-09-22 10:06:23,930 [INFO] {
    "loss": 2.0993922,
    "pesq": 2.66223,
    "avg_acc_identity": 0.492025-09-22 10:08:09,171 [INFO] {
    "2025-09-22 10:08:09,171 [INFO] {
    "loss": 2.0952139,
    "pesq": 2.69185,
    "avg_acc_identity": 0.502025-09-22 10:09:53,736 [INFO] {
    "2025-09-22 10:09:53,736 [INFO] {
    "loss": 2.0935291,
    "pesq": 2.72265,
    "avg_acc_identity": 0.492025-09-22 10:11:38,732 [INFO] {
    "2025-09-22 10:11:38,732 [INFO] {
    "loss": 2.08937,
    "pesq": 2.75094,
    "avg_acc_identity": 0.492025-09-22 10:13:23,846 [INFO] {
    "2025-09-22 10:13:23,846 [INFO] {
    "loss": 2.0853866,
    "pesq": 2.76834,
    "avg_acc_identity": 0.42025-09-22 10:15:08,231 [INFO] {
    "2025-09-22 10:15:08,231 [INFO] {
    "loss": 2.082091,
    "pesq": 2.78929,
    "avg_acc_identity": 0.502025-09-22 10:16:52,844 [INFO] {
    "2025-09-22 10:16:52,844 [INFO] {
    "loss": 2.079379,
    "pesq": 2.81,
    "avg_acc_identity": 0.502025-09-22 10:18:36,794 [INFO] {
    "2025-09-22 10:18:36,794 [INFO] {
    "loss": 2.0756785,
    "pesq": 2.83742,
    "avg_acc_identity": 0.502025-09-22 10:20:21,193 [INFO] {
    "2025-09-22 10:20:21,193 [INFO] {
    "loss": 2.0726061,
    "pesq": 2.8612,
    "avg_acc_identity": 0.502025-09-22 10:22:06,946 [INFO] {
    "2025-09-22 10:22:06,946 [INFO] {
    "loss": 2.0700595,
    "pesq": 2.88353,
    "avg_acc_identity": 0.502025-09-22 10:23:50,887 [INFO] {
    "2025-09-22 10:23:50,887 [INFO] {
    "loss": 2.0666306,
    "pesq": 2.89857,
    "avg_acc_identity": 0.502025-09-22 10:25:35,977 [INFO] {
    "2025-09-22 10:25:35,977 [INFO] {
    "loss": 2.0644737,
    "pesq": 2.91742,
    "avg_acc_identity": 0.502025-09-22 10:27:19,270 [INFO] {
    "2025-09-22 10:27:19,270 [INFO] {
    "loss": 2.060345,
    "pesq": 2.93932,
    "avg_acc_identity": 0.52025-09-22 10:29:01,654 [INFO] {
    "2025-09-22 10:29:01,654 [INFO] {
    "loss": 2.0553889,
    "pesq": 2.9624,
    "avg_acc_identity": 0.512025-09-22 10:30:45,228 [INFO] {
    "2025-09-22 10:30:45,228 [INFO] {
    "loss": 2.0493428,
    "pesq": 2.98299,
    "avg_acc_identity": 0.512025-09-22 10:32:29,844 [INFO] {
    "2025-09-22 10:32:29,844 [INFO] {
    "loss": 2.0403788,
    "pesq": 3.00498,
    "avg_acc_identity": 0.522025-09-22 10:34:15,775 [INFO] {
    "2025-09-22 10:34:15,775 [INFO] {
    "loss": 2.028151,
    "pesq": 3.02527,
    "avg_acc_identity": 0.522025-09-22 10:35:59,070 [INFO] {
    "2025-09-22 10:35:59,070 [INFO] {
    "loss": 2.0129053,
    "pesq": 3.04487,
    "avg_acc_identity": 0.52025-09-22 10:37:43,306 [INFO] {
    "2025-09-22 10:37:43,306 [INFO] {
    "loss": 1.9944135,
    "pesq": 3.05653,
    "avg_acc_identity": 0.542025-09-22 10:39:26,511 [INFO] {
    "2025-09-22 10:39:26,511 [INFO] {
    "loss": 1.9723651,
    "pesq": 3.05754,
    "avg_acc_identity": 0.552025-09-22 10:41:11,743 [INFO] {
    "2025-09-22 10:41:11,743 [INFO] {
    "loss": 1.9492593,
    "pesq": 3.05907,
    "avg_acc_identity": 0.562025-09-22 10:42:57,553 [INFO] {
    "2025-09-22 10:42:57,553 [INFO] {
    "loss": 1.9223466,
    "pesq": 3.05232,
    "avg_acc_identity": 0.572025-09-22 10:44:41,846 [INFO] {
    "2025-09-22 10:44:41,846 [INFO] {
    "loss": 1.9000151,
    "pesq": 3.05986,
    "avg_acc_identity": 0.582025-09-22 10:46:25,281 [INFO] {
    "2025-09-22 10:46:25,281 [INFO] {
    "loss": 1.8760182,
    "pesq": 3.06547,
    "avg_acc_identity": 0.592025-09-22 10:48:11,200 [INFO] {
    "2025-09-22 10:48:11,200 [INFO] {
    "loss": 1.8532205,
    "pesq": 3.06815,
    "avg_acc_identity": 0.62025-09-22 10:49:54,274 [INFO] {
    "2025-09-22 10:49:54,274 [INFO] {
    "loss": 1.8297257,
    "pesq": 3.07379,
    "avg_acc_identity": 0.612025-09-22 10:51:37,148 [INFO] {
    "2025-09-22 10:51:37,148 [INFO] {
    "loss": 1.8042724,
    "pesq": 3.0739,
    "avg_acc_identity": 0.622025-09-22 10:53:19,757 [INFO] {
    "2025-09-22 10:53:19,757 [INFO] {
    "loss": 1.7833969,
    "pesq": 3.08377,
    "avg_acc_identity": 0.632025-09-22 10:55:05,167 [INFO] {
    "2025-09-22 10:55:05,167 [INFO] {
    "loss": 1.762722,
    "pesq": 3.08985,
    "avg_acc_identity": 0.642025-09-22 10:56:48,241 [INFO] {
    "2025-09-22 10:56:48,241 [INFO] {
    "loss": 1.7400783,
    "pesq": 3.09218,
    "avg_acc_identity": 0.62025-09-22 10:58:33,159 [INFO] {
    "2025-09-22 10:58:33,159 [INFO] {
    "loss": 1.725707,
    "pesq": 3.09784,
    "avg_acc_identity": 0.652025-09-22 11:00:17,297 [INFO] {
    "2025-09-22 11:00:17,297 [INFO] {
    "loss": 1.720311,
    "pesq": 3.11203,
    "avg_acc_identity": 0.62025-09-22 11:02:01,648 [INFO] {
    "2025-09-22 11:02:01,648 [INFO] {
    "loss": 1.7066745,
    "pesq": 3.12365,
    "avg_acc_identity": 0.662025-09-22 11:03:43,970 [INFO] {
    "2025-09-22 11:03:43,970 [INFO] {
    "loss": 1.6924477,
    "pesq": 3.1323,
    "avg_acc_identity": 0.672025-09-22 11:05:29,192 [INFO] {
    "2025-09-22 11:05:29,192 [INFO] {
    "loss": 1.6770646,
    "pesq": 3.1432,
    "avg_acc_identity": 0.682025-09-22 11:07:13,904 [INFO] {
    "2025-09-22 11:07:13,904 [INFO] {
    "loss": 1.6637718,
    "pesq": 3.15393,
    "avg_acc_identity": 0.682025-09-22 11:08:56,596 [INFO] {
    "2025-09-22 11:08:56,596 [INFO] {
    "loss": 1.6483242,
    "pesq": 3.16053,
    "avg_acc_identity": 0.692025-09-22 11:10:40,164 [INFO] {
    "2025-09-22 11:10:40,164 [INFO] {
    "loss": 1.6347302,
    "pesq": 3.17212,
    "avg_acc_identity": 0.692025-09-22 11:12:24,647 [INFO] {
    "2025-09-22 11:12:24,647 [INFO] {
    "loss": 1.619074,
    "pesq": 3.18139,
    "avg_acc_identity": 0.702025-09-22 11:14:08,246 [INFO] {
    "2025-09-22 11:14:08,246 [INFO] {
    "loss": 1.6033499,
    "pesq": 3.19001,
    "avg_acc_identity": 0.712025-09-22 11:15:52,775 [INFO] {
    "2025-09-22 11:15:52,775 [INFO] {
    "loss": 1.5871782,
    "pesq": 3.20015,
    "avg_acc_identity": 0.712025-09-22 11:17:37,200 [INFO] {
    "2025-09-22 11:17:37,200 [INFO] {
    "loss": 1.5726568,
    "pesq": 3.20791,
    "avg_acc_identity": 0.722025-09-22 11:19:20,294 [INFO] {
    "2025-09-22 11:19:20,294 [INFO] {
    "loss": 1.5565611,
    "pesq": 3.21472,
    "avg_acc_identity": 0.722025-09-22 11:21:03,503 [INFO] {
    "2025-09-22 11:21:03,503 [INFO] {
    "loss": 1.5408474,
    "pesq": 3.21902,
    "avg_acc_identity": 0.72025-09-22 11:22:47,489 [INFO] {
    "2025-09-22 11:22:47,489 [INFO] {
    "loss": 1.5313517,
    "pesq": 3.22283,
    "avg_acc_identity": 0.732025-09-22 11:24:30,943 [INFO] {
    "2025-09-22 11:24:30,943 [INFO] {
    "loss": 1.5220202,
    "pesq": 3.23093,
    "avg_acc_identity": 0.2025-09-22 11:26:15,164 [INFO] {
    "2025-09-22 11:26:15,164 [INFO] {
    "loss": 1.5132726,
    "pesq": 3.24003,
    "avg_acc_identity": 0.742025-09-22 11:27:59,063 [INFO] {
    "2025-09-22 11:27:59,063 [INFO] {
    "loss": 1.5040378,
    "pesq": 3.24783,
    "avg_acc_identity": 0.742025-09-22 11:29:41,534 [INFO] {
    "2025-09-22 11:29:41,534 [INFO] {
    "loss": 1.4945341,
    "pesq": 3.2547,
    "avg_acc_identity": 0.752025-09-22 11:31:24,725 [INFO] {
    "2025-09-22 11:31:24,725 [INFO] {
    "loss": 1.4817279,
    "pesq": 3.2609,
    "avg_acc_identity": 0.2025-09-22 11:31:25,238 [INFO] {
    "2025-09-22 11:31:25,238 [INFO] {
    "loss": 0.1850223,
    "p2025-09-22 11:32:10,131 [INFO] {
    "2025-09-22 11:32:10,131 [INFO] {
    "loss": 0.2033014,
    "p2025-09-22 11:32:55,922 [INFO] {
    "2025-09-22 11:32:55,922 [INFO] {
    "loss": 0.214335,
    "p2025-09-22 11:33:18,836 [INFO] Checkpo2025-09-22 11:33:18,836 [INFO] Checkpoint saved: model_ckpts/lj/wm_model_lj_pesq_3.375710466861725_acc_0.9788_gs.pt |2025-09-22 11:33:19,386 [INFO] Epoch: 202025-09-22 11:33:20,447 [INFO] {
    "2025-09-22 11:33:20,447 [INFO] {
    "loss": 0.7769727,
    "pesq": 3.5179,
    "avg_acc_identity": 02025-09-22 11:35:02,307 [INFO] {
    "2025-09-22 11:35:02,307 [INFO] {
    "loss": 0.8532346,
    "pesq": 3.51306,
    "avg_acc_identity": 0.2025-09-22 11:36:45,081 [INFO] {
    "2025-09-22 11:36:45,081 [INFO] {
    "loss": 0.8233705,
    "pesq": 3.64737,
    "avg_acc_identity": 0.992025-09-22 11:38:28,708 [INFO] {
    "2025-09-22 11:38:28,708 [INFO] {
    "loss": 0.8131373,
    "pesq": 3.68097,
    "avg_acc_identity": 0.992025-09-22 11:40:10,415 [INFO] {
    "2025-09-22 11:40:10,415 [INFO] {
    "loss": 0.8097051,
    "pesq": 3.67986,
    "avg_acc_identity": 0.992025-09-22 11:41:53,812 [INFO] {
    "2025-09-22 11:41:53,812 [INFO] {
    "loss": 0.7980589,
    "pesq": 3.63823,
    "avg_acc_identity": 0.992025-09-22 11:43:36,647 [INFO] {
    "2025-09-22 11:43:36,647 [INFO] {
    "loss": 0.8258637,
    "pesq": 3.63669,
    "avg_acc_identity": 0.982025-09-22 11:45:19,140 [INFO] {
    "2025-09-22 11:45:19,140 [INFO] {
    "loss": 0.8331594,
    "pesq": 3.6496,
    "avg_acc_identity": 0.982025-09-22 11:47:01,812 [INFO] {
    "2025-09-22 11:47:01,812 [INFO] {
    "loss": 0.8439952,
    "pesq": 3.65507,
    "avg_acc_identity": 0.92025-09-22 11:48:44,565 [INFO] {
    "2025-09-22 11:48:44,565 [INFO] {
    "loss": 0.8688191,
    "pesq": 3.64572,
    "avg_acc_identity": 0.2025-09-22 11:50:27,512 [INFO] {
    "2025-09-22 11:50:27,512 [INFO] {
    "loss": 0.8604568,
    "pesq": 3.65632,
    "avg_acc_identity": 0.92025-09-22 11:52:11,983 [INFO] {
    "2025-09-22 11:52:11,983 [INFO] {
    "loss": 0.8394809,
    "pesq": 3.65345,
    "avg_acc_identity": 0.982025-09-22 11:53:56,554 [INFO] {
    "2025-09-22 11:53:56,554 [INFO] {
    "loss": 0.8269387,
    "pesq": 3.64965,
    "avg_acc_identity": 0.982025-09-22 11:55:42,322 [INFO] {
    "2025-09-22 11:55:42,322 [INFO] {
    "loss": 0.8195456,
    "pesq": 3.65187,
    "avg_acc_identity": 0.982025-09-22 11:57:23,941 [INFO] {
    "2025-09-22 11:57:23,941 [INFO] {
    "loss": 0.8335691,
    "pesq": 3.64164,
    "avg_acc_identity": 0.982025-09-22 11:59:06,712 [INFO] {
    "2025-09-22 11:59:06,712 [INFO] {
    "loss": 0.8437602,
    "pesq": 3.64511,
    "avg_acc_identity": 02025-09-22 12:00:49,772 [INFO] {
    "2025-09-22 12:00:49,772 [INFO] {
    "loss": 0.8445193,
    "pesq": 3.64408,
    "avg_acc_identity": 0.982025-09-22 12:02:35,802 [INFO] {
    "2025-09-22 12:02:35,802 [INFO] {
    "loss": 0.8327447,
    "pesq": 3.64332,
    "avg_acc_identity": 0.982025-09-22 12:04:20,409 [INFO] {
    "2025-09-22 12:04:20,409 [INFO] {
    "loss": 0.8249875,
    "pesq": 3.63835,
    "avg_acc_identity": 0.92025-09-22 12:06:04,814 [INFO] {
    "2025-09-22 12:06:04,814 [INFO] {
    "loss": 0.8284168,
    "pesq": 3.6378,
    "avg_acc_identity": 0.982025-09-22 12:07:47,832 [INFO] {
    "2025-09-22 12:07:47,832 [INFO] {
    "loss": 0.8330946,
    "pesq": 3.63939,
    "avg_acc_identity": 0.982025-09-22 12:09:32,247 [INFO] {
    "2025-09-22 12:09:32,247 [INFO] {
    "loss": 0.8429478,
    "pesq": 3.64222,
    "avg_acc_identity": 0.92025-09-22 12:11:15,223 [INFO] {
    "2025-09-22 12:11:15,223 [INFO] {
    "loss": 0.8467592,
    "pesq": 3.64864,
    "avg_acc_identity": 0.92025-09-22 12:12:58,600 [INFO] {
    "2025-09-22 12:12:58,600 [INFO] {
    "loss": 0.8386998,
    "pesq": 3.64334,
    "avg_acc_identity": 0.982025-09-22 12:14:41,569 [INFO] {
    "2025-09-22 12:14:41,569 [INFO] {
    "loss": 0.8295487,
    "pesq": 3.64149,
    "avg_acc_identity": 0.982025-09-22 12:16:25,532 [INFO] {
    "2025-09-22 12:16:25,532 [INFO] {
    "loss": 0.8410854,
    "pesq": 3.63388,
    "avg_acc_identity": 0.982025-09-22 12:18:09,831 [INFO] {
    "2025-09-22 12:18:09,831 [INFO] {
    "loss": 0.8447373,
    "pesq": 3.64067,
    "avg_acc_identity": 0.982025-09-22 12:19:54,364 [INFO] {
    "2025-09-22 12:19:54,364 [INFO] {
    "loss": 0.847481,
    "pesq": 3.64043,
    "avg_acc_identity": 0.982025-09-22 12:21:36,851 [INFO] {
    "2025-09-22 12:21:36,851 [INFO] {
    "loss": 0.8447825,
    "pesq": 3.64148,
    "avg_acc_identity": 0.982025-09-22 12:23:21,323 [INFO] {
    "2025-09-22 12:23:21,323 [INFO] {
    "loss": 0.8359113,
    "pesq": 3.64019,
    "avg_acc_identity": 0.982025-09-22 12:25:04,637 [INFO] {
    "2025-09-22 12:25:04,637 [INFO] {
    "loss": 0.8294197,
    "pesq": 3.64131,
    "avg_acc_identity": 02025-09-22 12:26:49,524 [INFO] {
    "2025-09-22 12:26:49,524 [INFO] {
    "loss": 0.828036,
    "pesq": 3.64127,
    "avg_acc_identity": 0.982025-09-22 12:28:33,601 [INFO] {
    "2025-09-22 12:28:33,601 [INFO] {
    "loss": 0.824152,
    "pesq": 3.64562,
    "avg_acc_identity": 0.982025-09-22 12:30:17,669 [INFO] {
    "2025-09-22 12:30:17,669 [INFO] {
    "loss": 0.8196638,
    "pesq": 3.64771,
    "avg_acc_identity": 0.982025-09-22 12:32:01,678 [INFO] {
    "2025-09-22 12:32:01,678 [INFO] {
    "loss": 0.8160429,
    "pesq": 3.64799,
    "avg_acc_identity": 0.982025-09-22 12:33:45,710 [INFO] {
    "2025-09-22 12:33:45,710 [INFO] {
    "loss": 0.8168081,
    "pesq": 3.64771,
    "avg_acc_identity": 0.982025-09-22 12:35:28,388 [INFO] {
    "2025-09-22 12:35:28,388 [INFO] {
    "loss": 0.8133781,
    "pesq": 3.64998,
    "avg_acc_identity": 0.9854,
    "avg_acc_distorted": 0.8068
}
